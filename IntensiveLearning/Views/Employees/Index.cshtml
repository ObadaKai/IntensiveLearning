@model IEnumerable<IntensiveLearning.Database.Employee>

@{
    ViewBag.Title = "لائحة موظفين";
}
<div ng-controller="SearchCtrl">

    <h2>لائحة الموظفين</h2>
    @if (Session["AddSchoolEmployees"] != null || Session["AddSchoolManagers"] != null || Session["AddManagers"] != null || Session["AddCOManagers"] != null)
    {
        using (Html.BeginForm("Create", "Employees", FormMethod.Get))
        {
            <button type="submit" class="btn btn-warning">انشاء جديد</button>
        }
    }
    <div class="col-md-12" style="margin-bottom:20px;padding:0;border:0">
        <div class="col-md-10" style="margin:0;padding:0;border:0">
            <input type="text" class="form-control " style="display:inline-block !important;text-align:right" name="search" id="search" placeholder="...البحث" ng-change="EmployeeSearchBox()" ng-model="EmployeeSearchBoxData" />
        </div>
        <div class="col-md-2" style="margin:0;padding:0;border:0">
            <input type="date" class="form-control " style="display:inline-block !important;" name="searchdate" id="searchdate" ng-change="EmployeeSearchBox()" ng-model="EmployeeSearchBoxDate" />
        </div>
    </div>

    <div id="table_wrapper">

        <table class="table table-striped" ng-hide="EmployeeRazorForm">
            <thead>
                <tr class="bg-primary">

                    <th></th>
                    <th>الاثبات</th>
                    <th>
                        @Html.DisplayNameFor(model => model.Salary)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.Period.Name)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.EmployeeType.Type)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Center.Name)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.EDate)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.SDate)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.State)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.CType)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.Certificate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.BDate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.surname)
                    </th>




                    <th>
                        @Html.DisplayNameFor(model => model.name)
                    </th>

                </tr>
            </thead>
            <tbody>
                @if (Model != null)
                {
                    foreach (var item in Model)
                    {
                        <tr>

                            <td>
                                @if (item.EmployeeType.Manager == true)
                                {
                                    if (Session["AddManagers"] != null)
                                    {
                                        /**/
                                        if ((bool)Session["AddManagers"] == true)
                                        {

                                            <div style="width:130px;">
                                                <a href="/Employees/Delete/@item.id" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                                <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                                <a href="/Employees/Edit/@item.id" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>
                                                @*@Html.ActionLink("حذف", "Delete", new { id = item.id }, new { @class = "btn btn-danger" })
                                                    @Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })
                                                    @Html.ActionLink("تعديل", "Edit", new { id = item.id }, new { @class = "btn btn-success" })*@
                                            </div>
                                        }


                                    }
                                    else
                                    {
                                        <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>

                                        @*@Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })*@

                                    }
                                }
                                @if (item.EmployeeType.CoManager == true)
                                {
                                    if (Session["AddCoManagers"] != null)
                                    {
                                        /**/
                                        if ((bool)Session["AddCoManagers"] == true)
                                        {

                                            <div style="width:130px;">
                                                <a href="/Employees/Delete/@item.id" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                                <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                                <a href="/Employees/Edit/@item.id" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>
                                                @*@Html.ActionLink("حذف", "Delete", new { id = item.id }, new { @class = "btn btn-danger" })
                                                    @Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })
                                                    @Html.ActionLink("تعديل", "Edit", new { id = item.id }, new { @class = "btn btn-success" })*@
                                            </div>
                                        }


                                    }
                                    else
                                    {
                                        <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>

                                        @*@Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })*@

                                    }
                                }


                                @if (item.EmployeeType.SchoolManager == true)
                                {
                                    if (Session["AddSchoolManagers"] != null)
                                    {
                                        /**/
                                        if ((bool)Session["AddSchoolManagers"] == true)
                                        {

                                            <div style="width:130px;">
                                                <a href="/Employees/Delete/@item.id" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                                <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                                <a href="/Employees/Edit/@item.id" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>
                                                @*@Html.ActionLink("حذف", "Delete", new { id = item.id }, new { @class = "btn btn-danger" })
                                                    @Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })
                                                    @Html.ActionLink("تعديل", "Edit", new { id = item.id }, new { @class = "btn btn-success" })*@
                                            </div>
                                        }


                                    }
                                    else
                                    {
                                        <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>

                                        @*@Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })*@

                                    }
                                }
                                @if (item.EmployeeType.NormalEmployee == true)
                                {
                                    if (Session["AddSchoolEmployees"] != null)
                                    {
                                        /**/
                                        if ((bool)Session["AddSchoolEmployees"] == true)
                                        {

                                            <div style="width:130px;">
                                                <a href="/Employees/Delete/@item.id" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                                <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                                <a href="/Employees/Edit/@item.id" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>
                                                @*@Html.ActionLink("حذف", "Delete", new { id = item.id }, new { @class = "btn btn-danger" })
                                                    @Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })
                                                    @Html.ActionLink("تعديل", "Edit", new { id = item.id }, new { @class = "btn btn-success" })*@
                                            </div>
                                        }


                                    }
                                    else
                                    {
                                        <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>

                                        @*@Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })*@

                                    }
                                }
                                else if (item.EmployeeType.NormalEmployee != true && item.EmployeeType.SchoolManager != true && item.EmployeeType.CoManager != true && item.EmployeeType.Manager != true)
                                {
                                    if (Session["SeeTeachers"] == null && (Session["AddSchoolEmployees"] != null || Session["AddSchoolManagers"] != null || Session["AddCoManagers"] != null || Session["AddManagers"] != null))
                                    {
                                        <a href="/Employees/Delete/@item.id" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                        <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                        <a href="/Employees/Edit/@item.id" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>

                                    }
                                    else
                                    {
                                        <a href="/Employees/Details/@item.id" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                    }
                                    @*@Html.ActionLink("معلومات", "Details", new { id = item.id }, new { @class = "btn btn-info", @style = "margin:0 4px 0 4px " })*@

                                }
                            </td>
                            <td>
                                @{ var ImageName = item.Proof;
                                    if (item.Proof != null)
                                    {
                                        <a href="@Url.Action("DownloadProof", "Json", new { ImageName = item.Proof} )" class="btn btn-warning"><span class="glyphicon glyphicon-download-alt"></span></a>

                                        @*@Html.ActionLink("تحميل", "DownloadProof", "Json", new { ImageName = item.Proof }, new { @class = "btn btn-warning" })*@
                                    }
                                }
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Salary)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Period.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EmployeeType.Type)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Center.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.EDate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.SDate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.State)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CType)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Certificate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.BDate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.surname)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.name)
                            </td>
                        </tr>
                                        }
                                    }
            </tbody>
        </table>
    </div>


    <button id="btnExport" class="btn btn-warning" ng-hide="EmployeeRazorForm">Export to xls</button>

    <div id="table_wrapper2">
        <table class="table table-striped" ng-cloak ng-show="EmployeeAngularForm">
            <thead>
                <tr class="bg-primary">
                    <th></th>
                    <th>الاثبات</th>
                    <th>
                        @Html.DisplayNameFor(model => model.Salary)
                    </th>


                    <th>
                        @Html.DisplayNameFor(model => model.Period.Name)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.EmployeeType.Type)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Center.Name)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.EDate)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.SDate)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.State)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.CType)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.Certificate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.BDate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.surname)
                    </th>




                    <th>
                        @Html.DisplayNameFor(model => model.name)
                    </th>

                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="Exam in Exams">
                    <td>


                        <div style="width:130px;" ng-if="Exam.EmpManager==true">
                            @if (Session["AddManagers"] != null)
                            {
                                if ((bool)Session["AddManagers"] == true)
                                {
                                    <a href="/Employees/Delete/{{Exam.ID}}" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                    <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                    <a href="/Employees/Edit/{{Exam.ID}}" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>
                                }



                            }
                            else
                            {
                                <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                            }
                        </div>
                        <div style="width:130px;" ng-if="Exam.EmpCoManager==true">

                            @if (Session["AddCoManagers"] != null)
                            {
                                if ((bool)Session["AddCoManagers"] == true)
                                {
                                    <a href="/Employees/Delete/{{Exam.ID}}" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                    <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                    <a href="/Employees/Edit/{{Exam.ID}}" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>
                                }

                            }
                            else
                            {
                                <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                            }
                        </div>


                        <div style="width:130px;" ng-if="Exam.EmpSchoolManager==true">

                            @if (Session["AddSchoolManagers"] != null)
                            {
                                /**/
                                if ((bool)Session["AddSchoolManagers"] == true)
                                {
                                    <a href="/Employees/Delete/{{Exam.ID}}" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                    <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                    <a href="/Employees/Edit/{{Exam.ID}}" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>
                                }

                            }
                            else
                            {
                                <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                            }
                        </div>
                        <div style="width:130px;" ng-if="Exam.EmpNormal==true">

                            @if (Session["AddSchoolEmployees"] != null)
                            {
                                /**/
                                if ((bool)Session["AddSchoolEmployees"] == true)
                                {
                                    <a href="/Employees/Delete/{{Exam.ID}}" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                    <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                    <a href="/Employees/Edit/{{Exam.ID}}" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>
                                }

                            }
                            else
                            {
                                <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                            }
                        </div>
                        <div ng-if="Exam.EmpManager!=true && Exam.EmpCoManager!=true && Exam.EmpSchoolManager!=true && Exam.EmpNormal!=true">
                            @if (Session["SeeTeachers"] == null && (Session["AddSchoolEmployees"] != null || Session["AddSchoolManagers"] != null || Session["AddCoManagers"] != null || Session["AddManagers"] != null))
                            {
                                <a href="/Employees/Delete/{{Exam.ID}}" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>
                                <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                                            <a href="/Employees/Edit/{{Exam.ID}}" class="btn btn-success"><span class="glyphicon glyphicon-pencil"></span></a>

                            }
                            else
                            {
                                <a href="/Employees/Details/{{Exam.ID}}" class="btn btn-info"><span class="glyphicon glyphicon-folder-open"></span></a>
                            }
                        </div>




                    </td>
                    <td>
                        <span ng-if="Exam.Proof != null">
                            <a href="/Json/DownloadProof/{{Exam.Proof}}" class="btn btn-warning">تحميل</a>
                        </span>
                    </td>

                    <td>{{Exam.Salary}}</td>
                    <td>{{Exam.Period}}</td>

                    <td>{{Exam.EmployeeType}}</td>
                    <td>{{Exam.Center}}</td>
                    <td>{{Exam.EmployeeEDate | date:'MM/dd/yyyy'}}</td>
                    <td>{{Exam.EmployeeSDate | date:'MM/dd/yyyy'}}</td>
                    <td>{{Exam.State}}</td>
                    <td>{{Exam.CType}}</td>
                    <td>{{Exam.Certificate}}</td>
                    <td>{{Exam.EmployeeBDate | date:'MM/dd/yyyy'}}</td>
                    <td>{{Exam.surname}}</td>
                    <td>{{Exam.name}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <button id="btnExport2" class="btn btn-warning" ng-cloak ng-show="EmployeeAngularForm">Export to xls</button>
</div>
@if (ViewBag.StateMessage != null)
{
    <div class="alert alert-success alert-dismissible" role="alert" style="width:inherit;position:absolute;bottom:5%;" id="ToFadeMessage">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        @ViewBag.StateMessage
    </div>
}